<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" target="Rebuild">
	
	<PropertyGroup>
		<SourceDir>$(MSBuildProjectDirectory)</SourceDir>
		<BuildDir>$(MSBuildProjectDirectory)\Build</BuildDir>
		<DeployDir>$(SourceDir)\Deploy</DeployDir>		
		<Configuration>Release</Configuration>
		<Platform>x86</Platform>
	</PropertyGroup>
	
	<UsingTask 
		AssemblyFile="$(SourceDir)\packages\xunit.1.9.0.1566\lib\xunit.runner.msbuild.dll"
		TaskName="Xunit.Runner.MSBuild.xunit" />
	
	<ItemGroup>
		<SolutionFile 
			Include="$(SourceDir)\ProjectEuler.sln" />
	</ItemGroup>
	
	<Target Name="Clean">
		<MSBuild 
			Projects="@(SolutionFile)" 
			Targets="Clean" 
			Properties="Configuration=$(Configuration);Platform=$(Platform);OutputPath=$(BuildDir)" />		
		<RemoveDir 
			Directories="$(DeployDir)" 
			ContinueOnError="True" />
	</Target>
	
	<Target Name="Build">
		<MSBuild 
			Projects="@(SolutionFile)" 
			Properties="Configuration=$(Configuration);Platform=$(Platform);OutputPath=$(BuildDir)" />		
	</Target>		
	
	<Target Name="Rebuild">
		<CallTarget 
			Targets="Clean; Build; Test" />		
	</Target>		
	
	<Target Name="Deploy" DependsOnTargets="Rebuild">
		<Copy 
			SourceFiles="$(BuildDir)\Euler.exe" 
			DestinationFolder="$(DeployDir)" />
		<Copy 
			SourceFiles="$(BuildDir)\ProjectEuler.Problems.dll" 
			DestinationFolder="$(DeployDir)" />			
		<Copy 
			SourceFiles="$(BuildDir)\Tools.dll" 
			DestinationFolder="$(DeployDir)" />		
	</Target>
	
	<Target Name="Test" DependsOnTargets="Build">
		<xunit Assembly="$(BuildDir)\ProjectEuler.Tests.dll" />
	</Target>	
</Project>
